\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{civl}[CIVL package]

\RequirePackage{fontspec} % set input encoding (not needed with XeLaTeX)
\RequirePackage{tabularx}
\RequirePackage{multicol}
\RequirePackage{multirow}

\RequirePackage{xcolor}
\RequirePackage{import}
\RequirePackage{hyperref}
\RequirePackage{graphicx}
\RequirePackage{booktabs}
\RequirePackage[left=20mm, right=20mm, top=20mm, bottom=20mm]{geometry}
\RequirePackage{amsmath}
\RequirePackage{array}

% SEE: http://stackoverflow.com/questions/3244803/latex-add-clickable-links-to-a-section-subsection-with-a-pdf-document
\hypersetup{
  colorlinks   = true,    % Colours links instead of ugly boxes
  urlcolor     = blue,    % Colour for external hyperlinks
  linkcolor    = blue,    % Colour of internal links
  citecolor    = red      % Colour of citations
}
%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\usepackage{datetime}

\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\footrulewidth}{0.4pt}
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{}\rfoot{\thepage}

% SEE: http://texblog.org/2007/11/07/headerfooter-in-latex-with-fancyhdr/
\fancypagestyle{gen}{
\chead{CIVL GAP â€“ Centralised Cross-Country Competition Scoring for Hang-Gliding and Paragliding}
\lfoot{2016 Edition, Revision 1.1}
\cfoot{\date{\texttt{{\ddmmyyyydate\today} \currenttime}}}
}

\providecommand{\HUGE}{\Huge}% if not using memoir

% SEE: https://tex.stackexchange.com/questions/23957/how-to-set-font-to-arial-throughout-the-entire-document
\setmainfont{Arial}

% SEE: https://tex.stackexchange.com/questions/313860/how-to-have-the-arctan2-atan2-function-in-latex
\DeclareMathOperator{\atantwo}{atan2}

% SEE: https://www.sharelatex.com/learn/Paragraph_formatting#!#Paragraph_spacing
\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

\definecolor{pgc}{RGB}{250,191,143}
\definecolor{hgc}{RGB}{146,205,220}

% SEE: https://tex.stackexchange.com/questions/89166/centering-in-tabularx-and-x-columns
% SEE: https://tex.stackexchange.com/questions/12703/how-to-create-fixed-width-table-columns-with-text-raggedright-centered-raggedlef
\newcolumntype{R}{>{\raggedleft\arraybackslash}X}

% SEE: https://tex.stackexchange.com/questions/29060/newenvironment-issues-with-environment-comment
\newsavebox{\coloredbgbox}
\newenvironment{pg}
{
    \begin{lrbox}{\coloredbgbox}\begin{minipage}{\textwidth}
}
{
    \end{minipage}
    \end{lrbox}
    \colorbox{pgc}{\usebox{\coloredbgbox}}
    \marginpar{\includegraphics[scale=0.6]{pg.png}\hfill}
}

\newenvironment{hg}
{
    \begin{lrbox}{\coloredbgbox}\begin{minipage}{\textwidth}
}
{
    \end{minipage}
    \end{lrbox}
    \colorbox{hgc}{\usebox{\coloredbgbox}}
    \marginpar{\includegraphics[scale=1.2]{hg.png}\hfill}
}

% SEE: https://tex.stackexchange.com/questions/33401/a-version-of-colorbox-that-works-inside-math-environments
\newcommand{\pgh}[2][pgc]{\mathchoice%
  {\colorbox{#1}{$\displaystyle#2$}}%
  {\colorbox{#1}{$\textstyle#2$}}%
  {\colorbox{#1}{$\scriptstyle#2$}}%
  {\colorbox{#1}{$\scriptscriptstyle#2$}}}%

\newcommand{\hgh}[2][hgc]{\mathchoice%
  {\colorbox{#1}{$\displaystyle#2$}}%
  {\colorbox{#1}{$\textstyle#2$}}%
  {\colorbox{#1}{$\scriptstyle#2$}}%
  {\colorbox{#1}{$\scriptscriptstyle#2$}}}%
