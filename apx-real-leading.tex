% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode
\documentclass[gap.tex]{subfiles}
\begin{document}
\label{sec:real-leading}
Real\footnotemark leading points are a proposed change to leading points.
\footnotetext{Even these are not \textbf{real} leading points. The combination
of a pilot's relative progress and whether or not they are following is being
used as a more accurate proxy for leading.}

\subsection{Motivation}
Leading points should represent how long the pilots lead in front of other
pilots. Leading a group of pilots brings tactical risks and should be rewarded
appropriately.

\subsection{Criticism of Leading Points}
Leading points would be better described as progress points as they reward
pilots' relative progress along the course.

\subsection{The Proposal}
This proposal refines leading points to reward leading by;

\begin{enumerate}
    \item Renaming \textbf{leading} and \(LC\) to \textbf{progress} and \(PC\),
        keeping the rules around progress the same,
        see~\ref{sec:leading-points}.

    \item Adding \(SC\), a new coefficient representing a pilot's time spent
        flying solo.

    \item Awarding leading points as the fraction \(LC = SC * PC\) of points
        available for leading.
\end{enumerate}

\subsection{The Model}

\begin{figure}[ht]
    \centering
    \input{dia/real-leading/view-port}
    \caption{Plan view of the flying solo view port. Pilots 1 and 2 are following while pilots 3, 4 and 5 are flying solo.}
    \label{fig:view-port}
\end{figure}

A pilot when flying has a position and is moving. The heading, climb rate and
speed can be represented by a vector. A competition pilot scans for other
pilots to follow or to join in order to climb. We can't see what the pilot sees
but we could model this field of view or viewport\footnote{Something like
shining a spotlight at night.}. A pilot's visual acuity is limited and so is
glide slope angle so at some distance other pilots are too far away to worry
about. A distance limited field of view along a glide slope defines a volume.
Let's deem a pilot to be following if there are other pilots in this volume
that we'll call the black zone.

Let's also define a larger volume by extending the field of view and range. If
all other pilots are outside this then our pilot is definitely not following.
If some pilots are in this volume but not in the smaller volume then our pilot
is somewhat following. The larger volume minus the smaller one we'll call the
gray zone.

\subsection{Dampening}
It may be necessary to dampen the movement vector \(V\) by integrating it over
some time interval in order to smooth out fluctuations. We may find that one
smoothing is needed to better identify climbing flight when thermalling.
Another smoothing may be needed to prevent pilots from gaming this rule by
tacking away from the pilot they are infact following.

\subsection{Calculation Steps}

\begin{enumerate}
    \item \textbf{Interpolate between tracklog fixes}\footnotemark in the speed
        section to get a position \((x, y, z)\) and a unit movement vector
        \((vx, vy, vz)\) every second\footnotetext{The interpolation step must
        be done after the analysis of the flight has detected SSS, ESS and
        whether the pilot made goal or landed-out.}. Interpolation\footnote{The
        suggested interpolation to use is linear.} will always be
        necessary\footnote{Even a tracklog with fixes every second may not be
        properly in phase with the second marks we choose and tracklogs often
        have gaps.} and may be made in one or two passes\footnote{First pass to
        interpolate all positions and movement vectors and second pass to
        dampen these.}.

    \item \textbf{Calculate solo time ratio} \(SR\). Exclude
        thermalling\footnote{If the angle between the movement vector and
        vertical axis is less than 60° then exclude that second deemed to be
        "thermalling" flight.} and assess whether the pilot is flying solo for
        the remaining points and vectors.
    
        To calculate \(ST_i\) and \(GT_i\) for all pilots:

        In the above pseudo-code \(BZA\) is black zone angle, \(BZR\) is black
        zone radius, \(GZA\) is grey zone angle and \(GZR\) is grey zone
        radius. At the end of this step we must have minimum and maximum
        leading time ratio \(SR_{min}\) and \(SR_{max}\).

    \item \textbf{Calculate progress coefficients} \(PC_i\).
        
        \begin{align*}
            PC_i &= ProgressPoints_i / ProgressPoints_{max}\footnotemark
        \end{align*}
        \footnotetext{Progress in this proposal is a renaming of leading so
        \(PC = LC\) as calculated currently.}

    \item \textbf{Calculate solo coefficients} \(SC_i\).
        
        \begin{align*}
            LE_i &= (SR_i – SR_{min}) / (SR_{max} – SR_{min}) \\
            SC_i &= SC_{min} + (2*LE_i – LE_i * LE_i) * (1 – SC_{min}) \\
        \end{align*}
            
    \item \textbf{Calculate leading coefficients} \(LC_i\).
        
        \begin{align*}
            LC_i &= PC_i * SC_i
        \end{align*}
            
    \item \textbf{Calculate the leading points for all pilots}
        
        \begin{align*}
            LP_i &= AvailableLeadingPoints * (M_i – M_{min}) / (M_{max} – M_{min} )
        \end{align*}
\end{enumerate}

\subsection{Scenarios}

\begin{enumerate}
    \item Pilot A leading the first gaggle through the whole task will have
        maximum solo time ratio, leading coefficient equal to 1, progress
        coefficient equal to 1 and finally will get 100\% of the available
        leading points.

    \item Pilot B following the Pilot A through the whole task will have close
        to zero solo time ratio, 0.2 * 0.3 leading coefficient, progress
        coefficient close to 1 and finally will get about 6\% of the available
        leading points.

    \item Pilot C leading the second gaggle through the whole task will have
        maximum solo time ratio, leading coefficient equal to 1, progress
        coefficient 0.8 * 0.9 and finally will get 72\% of the available
        leading points.

    \item Pilot D who makes the task far behind all other pilots, flying the
        whole task alone will get maximum solo time ratio, leading coefficient
        equal to 1, but will get 0 progress coefficient and finally will get
        0 leading points.
\end{enumerate}

\subsection{Default Parameters}
The angles should be the lower and upper limits of the angle a pilot is looking
sideways for other pilots.  The radii should be lower and upper limits of the
distance that separates one group of pilots from the next.

\begin{table}[!ht]
    \begin{tabularx}{\textwidth}{|l|X|c|c|}
    \hline
        & \textbf{Parameter}
        & \textbf{HG}
        & \textbf{PG}
        \\
    \hline
        \multirow{2}{*}{Black Zone}
        & Angle
        & 45°
        & 45°
        \\
    \cline{2-4}
        & Radius
        & $1500 m$
        & $2000 m$
        \\
    \hline
        \multirow{2}{*}{Gray Zone}
        & Angle
        & 60°
        & 60°
        \\
    \cline{2-4}
        & Radius
        & $2000 m$
        & $2500 m$
        \\
    \hline
        \multirow{2}{*}{Solo time coefficient}
        & $SC_{min}$
        & 0.2
        & 0.2
        \\
    \cline{2-4}
        & $SC_{max}$
        & 1.0
        & 1.0
        \\
    \hline
        \multirow{3}{*}{}
        & Thermalling Angle
        & 60°
        & 60°
        \\
    \cline{2-4}
        & Dampening Time
        & $20 secs$
        & $20 secs$
        \\
    \hline
    \end{tabularx}
    \caption{Proposed default values for real leading point parameters.}
    \label{tab:gap-defaults}
\end{table}
\end{document}
